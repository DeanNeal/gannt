{"version":3,"sources":["api.js"],"names":[],"mappings":"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","file":"api.js","sourcesContent":["var $ = require('jquery'),\r\n    _ = require('underscore');\r\n\r\nvar Api = function (entryPoint) {\r\n\tif (this.instance)\r\n\t\tthrow new Error('You can not create more than one instance of API. Use Api.getInstance()');\r\n\tthis.entryPoint = entryPoint;\r\n\tthis.catalog = undefined;\r\n};\r\n\r\nApi.getInstance = function (entryPoint) {\r\n\tif (!Api.instance)\r\n\t\tApi.instance = new Api(entryPoint);\r\n\treturn Api.instance;\r\n};\r\nApi.prototype.getCatalog = function () {\r\n\tvar deferred = $.Deferred();\r\n\r\n\t$.get(this.entryPoint, function (data) {\r\n\t\tthis.catalog = data;\r\n\t\tdeferred.resolve(data);\r\n\t}.bind(this));\r\n\treturn deferred.promise();\r\n};\r\n\r\nApi.prototype.getResousceFromCatalog = function (resourceName, data) {\r\n\tvar url      = _.findWhere(this.catalog.links, {id: resourceName}).href,\r\n\t    deferred = $.Deferred();\r\n\r\n\t$.get(url, data, function (data) {\r\n\t\tdeferred.resolve(data);\r\n\t}.bind(this));\r\n\r\n\treturn deferred.promise();\r\n};\r\n\r\nApi.prototype.getUrl = function (collection, id) {\r\n\tvar model = _.findWhere(collection, {id: id});\r\n\treturn (model) ? model.links[0].href : '';\r\n};\r\n\r\nApi.prototype.getUrlFromCatalog = function (resourceName) {\r\n\treturn _.findWhere(this.catalog.links, {id: resourceName}).href;\r\n};\r\n\r\nfunction generateQuery(data) {\r\n\tvar deferred = $.Deferred();\r\n\r\n\t$.ajax(data).done(function (data) {\r\n\t\tdeferred.resolve(data);\r\n\t});\r\n\r\n\treturn deferred.promise();\r\n}\r\n\r\nApi.prototype.getResourceByUrl = function (url , data) {\r\n\treturn generateQuery({\r\n\t\tmethod: 'get',\r\n\t\turl: url,\r\n\t\tdata: data\r\n\t});\r\n};\r\n\r\nApi.prototype.createResourceByUrl = function (url, data) {\r\n\treturn generateQuery({\r\n\t\tmethod: 'post',\r\n\t\turl: url,\r\n\t\tdata: data\r\n\t});\r\n};\r\n\r\nApi.prototype.updateResourceByUrl = function (url, data) {\r\n\treturn generateQuery({\r\n\t\tmethod: 'put',\r\n\t\turl: url,\r\n\t\tdata: data\r\n\t});\r\n};\r\n\r\nApi.prototype.deleteResourceByUrl = function (url) {\r\n\treturn generateQuery({\r\n\t\tmethod: 'delete',\r\n\t\turl: url\r\n\t});\r\n};\r\n\r\nmodule.exports = Api;"],"sourceRoot":"/source/"}